var cChannels=cChannels||{channelArray:new Array};cChannels.initChannels=function(){cChannels.channelArray.push({displayName:"Opacity",name:"opacity",template:"timeline_channel_simple",getValue:function(e){return 100*e.style.opacity||100},applyValue:function(e,n){e.style.opacity=n/100}}),cChannels.channelArray.push({displayName:"X position",name:"xposition",template:"timeline_channel_simple",getValue:function(e){return parseInt(e.style.left)},applyValue:function(e,n){e.style.left=n+"px"}}),cChannels.channelArray.push({displayName:"Y position",name:"yposition",template:"timeline_channel_simple",getValue:function(e){return parseInt(e.style.top)},applyValue:function(e,n){e.style.top=n+"px"}}),cChannels.channelArray.push({displayName:"Scale",name:"scale",template:"timeline_channel_scale",components:["scaleX","scaleY"],getValue:function(e){var n=e.style.transform,t=cChannels.decomposeTransform(n);return{x:100*t.sx,y:100*t.sy}},applyValue:function(e,n){var t=e.style.transform,a="scale("+n.x/100+","+n.y/100+")",i=cChannels.addTransformCompnent(t,a,"scale");e.style.transform=i,e.style.webkitTransform=i}}),cChannels.channelArray.push({displayName:"Rotation",name:"rotation",components:["rotate"],template:"timeline_channel_simple",getValue:function(e){var n=e.style.transform,t=cChannels.decomposeTransform(n);return t.r},applyValue:function(e,n){var t=e.style.transform,a=cChannels.addTransformCompnent(t,"rotate("+n+"deg)","rotate");e.style.transform=a,e.style.webkitTransform=a}}),cChannels.channelArray.push({displayName:"Rotation 3D",name:"rotate3d",components:["rotateX","rotateY","rotateZ"],template:"timeline_channel_rotate3d",getValue:function(e){var n=e.style.transform,t=cChannels.decomposeTransform(n);return{x:t.rx,y:t.ry,z:t.rz}},applyValue:function(e,n){var t=e.style.transform,a=cChannels.addTransformCompnent(t,"rotateX("+n.x+"deg)","rotateX");a=cChannels.addTransformCompnent(a,"rotateY("+n.y+"deg)","rotateY"),a=cChannels.addTransformCompnent(a,"rotateZ("+n.z+"deg)","rotateZ"),e.style.transform=a,e.style.webkitTransform=a}}),cChannels.channelArray.push({displayName:"Translate 3D",name:"translate3d",components:["translateX","translateY","translateZ"],template:"timeline_channel_translate3d",getValue:function(e){var n=e.style.transform,t=cChannels.decomposeTransform(n);return{x:t.tx,y:t.ty,z:t.tz}},applyValue:function(e,n){var t=e.style.transform,a=cChannels.addTransformCompnent(t,"translate3d("+n.x+"px,"+n.y+"px,"+n.z+"px)","translate3d");e.style.transform=a,e.style.webkitTransform=a}})},cChannels.getChannelFromName=function(e){for(var n in cChannels.channelArray)if(n=cChannels.channelArray[n],n.name===e)return n;return null},cChannels.getCurrentValueForChannel=function(e,n,t){var a=cChannels.getChannelFromName(n);return a.getValue(e)},cChannels.applyValueToChannel=function(e,n,t,a){var i=cChannels.getChannelFromName(t);i.applyValue(e,n)},cChannels.decomposeTransform=function(e){var n=e.split(/\s+(?![^\[]*\]|[^(]*\)|[^\{]*})/),t={tx:0,ty:0,tz:0,r:0,rx:0,ry:0,rz:0,sx:1,sy:1};for(var a in n){var i=n[a];if(i.indexOf("translate3d")){var r=cChannels.decomposeTransformC(i);t.tx=parseFloat(r[0])||0,t.ty=parseFloat(r[1])||0,t.tz=parseFloat(r[2])||0}i.indexOf("rotate(")!=-1&&(t.r=parseFloat(i.match(/\d+/)[0])||0),i.indexOf("rotateX")!=-1&&(t.rx=parseFloat(i.match(/\d+/)[0])||0),i.indexOf("rotateY")!=-1&&(t.ry=parseFloat(i.match(/\d+/)[0])||0),i.indexOf("rotateZ")!=-1&&(t.rz=parseFloat(i.match(/\d+/)[0])||0),i.indexOf("scale")!=-1&&(t.sx=parseFloat(i.match(/\d+/)[0])||1,t.sy=parseFloat(i.match(/\d+/)[0])||1)}return t},cChannels.decomposeTransformC=function(e){var n=e.split("(")[1];return n=n.split(")")[0],n=n.split(",")},cChannels.addTransformCompnent=function(e,n,t){if("string"==typeof e){var a=e.match(/\w+(\(.*?\))?/g),i=!1;for(var r in a){var l=a[r].match("^"+t+"[(]");l&&(i=!0,a[r]=n)}i||a.push(n);var m="";for(var r in a)m+=a[r]+" ";return m}return""},cChannels.initChannels(),function(){for(var e=0,n=["webkit","moz"],t=0;t<n.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[n[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[t]+"CancelAnimationFrame"]||window[n[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n,t){var a=(new Date).getTime(),i=Math.max(0,16-(a-e)),r=window.setTimeout(function(){n(a+i)},i);return e=a+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var TinyAnim={anim:null,targetEl:null,currentFrame:0,fps:null,interval:null,elements:null,onAdvanceFrame:null,onAnimationComplete:null,isPlaying:!1,options:null,playCount:0,animStartTime:0};TinyAnim.init=function(e,n,t){TinyAnim.anim=e,TinyAnim.targetEl=n||"Content",TinyAnim.fps=1e3/e.fps,TinyAnim.options=t||null,TinyAnim.elements=Array();var a=document.getElementById(TinyAnim.targetEl);a.style.width=TinyAnim.anim.stageWidth+"px",a.style.height=TinyAnim.anim.stageHeight+"px",a.style.hasOwnProperty("perspective")&&(a.style.perspective=TinyAnim.anim.fov+"px"),a.style.hasOwnProperty("perspectiveOrigin")&&(a.style.perspectiveOrigin=TinyAnim.anim.pOriginX+" "+TinyAnim.anim.pOriginY);for(var i in e.elements)e.elements[i].content=unescape(e.elements[i].content);for(;a.firstChild;)a.removeChild(a.firstChild);var r=new Array,l=!1;for(var m in TinyAnim.anim.elements){var s=TinyAnim.anim.elements[m];1==s.editorIsIsolated&&(l=!0)}for(var m in TinyAnim.anim.elements){var s=TinyAnim.anim.elements[m],o=document.createElement("div");o.setAttribute("id","TAnimEl"+m),o.setAttribute("name",s.name),o.setAttribute("class","tiny-element"),o.setAttribute("data-guid",s.guid||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0,t="x"==e?n:3&n|8;return t.toString(16)})),void 0!==s.parent&&null!==s.parent?(o.setAttribute("parent",s.parent),r.push(o)):void 0!==s.parentName&&null!==s.parentName&&(o.setAttribute("parentName",s.parentName),r.push(o)),s.editorIsLocked?(o.setAttribute("class","element-lock"),o.style.position="absolute"):o.style.position="absolute",o.setAttribute("data-layer-id",m),o.style.zIndex=s.zindex,o.style.top=s.defaultTop+"px",o.style.left=s.defaultLeft+"px";var y="translate3d(0,0,0)";o.style.transform=y,o.style.webkitTransform=y,o.style.transformStyle="preserve-3d",o.style.transformOrigin=s.tOrgX+" "+s.tOrgY,o.style.webkitTransformationOrigin=s.tOrgX+" "+s.tOrgY,o.animdata=s;var c=document.createElement("div");if(c.setAttribute("class","editor-wrapper"),1==l){var s=TinyAnim.anim.elements[m];0==s.editorIsIsolated?c.style.display="none":c.style.display="block"}else 0==s.editorVisibility?c.style.display="none":c.style.display="block";var p=document.createElement("div");s.editorIsSelected?p.setAttribute("class","selection-highlight semi"):p.setAttribute("class","selection-highlight"),c.innerHTML=s.content+p.outerHTML,"undefined"==typeof Project?o.innerHTML=s.content:o.appendChild(c),TinyAnim.elements.push(o),document.getElementById(TinyAnim.targetEl).appendChild(o)}for(var u in r){var d=r[u],f=d.getAttribute("parent");if(null!=f){var A=document.querySelectorAll('[data-guid="'+f+'"]');A[0].appendChild(d)}else{var h=d.getAttribute("parentName"),A=document.querySelectorAll('[name="'+h+'"]');A[0].appendChild(d)}}},TinyAnim.lerp=function(e,n,t,a){e=parseFloat(e),n=parseFloat(n);var i;switch(e==n&&(i=e),a){case"linear":i=e+t*(n-e);break;case"ease-out":t=Math.sin(1.5707*t),i=e+t*(n-e);break;case"ease-in":t=Math.cos(1.5707*t),i=e+t*(n-e);break;case"bounce":t=Math.cos(1.57079632*t*2)/2+.5,i=e+t*(n-e);break;default:return e+t*(n-e)}return i},TinyAnim.play=function(){"undefined"!=typeof window.performance&&"undefined"!=typeof window.performance.mark&&window.performance.clearMarks(),0==TinyAnim.isPlaying&&(TinyAnim.isPlaying=!0,TinyAnim.animStartTime=(new Date).getTime()-TinyAnim.currentFrame*TinyAnim.fps,TinyAnim.advanceFrameWhilePlaying())},TinyAnim.advanceFrameWhilePlaying=function(){var e=(new Date).getTime(),n=e-TinyAnim.animStartTime;TinyAnim.currentFrame=n/TinyAnim.fps,"undefined"!=typeof window.performance&&"undefined"!=typeof window.performance.mark&&window.performance.mark("beginframe"),TinyAnim.updateAnimation(),TinyAnim.currentFrame>TinyAnim.anim.length&&TinyAnim.playbackEnded(),TinyAnim.onAdvanceFrame&&TinyAnim.onAdvanceFrame(),TinyAnim.isPlaying&&window.requestAnimationFrame(function(){TinyAnim.advanceFrameWhilePlaying()}),"undefined"!=typeof window.performance&&"undefined"!=typeof window.performance.mark&&(window.performance.mark("endframe"),window.performance.measure("beginframe","endframe"))},TinyAnim.playbackEnded=function(){if(TinyAnim.playCount++,TinyAnim.onAnimationComplete&&TinyAnim.onAnimationComplete(),void 0!==window.performance&&"undefined"!=typeof cPerformance){var e=window.performance.getEntriesByType("measure");window.performance.clearMeasures(),cPerformance.fillWindow(e)}if("undefined"==typeof Project)switch(TinyAnim.options.playback){case"play_forever":TinyAnim.seek(0),setTimeout(function(){TinyAnim.play()},1);break;case"play_n_times":var n=parseInt(TinyAnim.options.loopcount),t=TinyAnim.playCount;t<n?(TinyAnim.seek(0),setTimeout(function(){TinyAnim.play()},1)):TinyAnim.isPlaying=!1;default:TinyAnim.isPlaying=!1}},TinyAnim.seek=function(e){TinyAnim.currentFrame=e,TinyAnim.animStartTime=(new Date).getTime()-TinyAnim.currentFrame*TinyAnim.fps,TinyAnim.updateAnimation()},TinyAnim.stop=function(){return TinyAnim.isPlaying=!1,TinyAnim.currentFrame},TinyAnim.updateAnimation=function(){for(var e in TinyAnim.elements){var n=TinyAnim.elements[e],t=n.animdata.keys;for(var a in t){var i,r,l=t[a],m=!1;if(l.keys.length>0){if(TinyAnim.currentFrame<l.keys[0].time&&(m=!0,i=0,r=0),TinyAnim.currentFrame>l.keys[l.keys.length-1].time&&(m=!0,i=l.keys.length-1,r=l.keys.length-1),m===!1)for(var s=0;s<l.keys.length;s++)if(TinyAnim.currentFrame>=l.keys[s].time)if(s+1<l.keys.length){if(TinyAnim.currentFrame<l.keys[s+1].time){i=s,r=s+1;break}i=s,r=s}else i=s,r=s;var o=l.channel,y=l.keys[r].time-l.keys[i].time,c=TinyAnim.currentFrame-l.keys[i].time;if(i!=r)var p=1-c/y;else var p=0;var u=l.keys[i].value,d=l.keys[r].value,f=l.keys[i].easing||"bounce";if("number"==typeof u&&"number"==typeof d)var A=TinyAnim.lerp(l.keys[i].value,l.keys[r].value,p,f);else{var A={};for(var h in u)if(u.hasOwnProperty(h)){var T=u[h],v=d[h],g=TinyAnim.lerp(T,v,p,f);A[h]=g}}cChannels.applyValueToChannel(n,A,o,null)}}}},TinyAnim.resolveGUID=function(e){for(var n in TinyAnim.anim.elements){var t=TinyAnim.anim.elements[n];if(t.guid==e)return t}return null},TinyAnim.checkCyclical=function(e,n,t){if(null!==e.parent){var a=TinyAnim.resolveGUID(e.parent);a.guid==n?t(!1):TinyAnim.checkCyclical(a,n,t)}else t(!0)};